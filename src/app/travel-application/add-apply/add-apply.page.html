<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <app-back-button></app-back-button>
    </ion-buttons>
    <ion-title>出差申请</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list style="background: transparent;">
    <ion-item detail (click)='onSelectOrg()' >
      <ion-label>
        所属部门
      </ion-label>
      <ion-label class="ion-text-end">{{searchModel.TravelForm?.Organization?.Name}} <ng-container
          *ngIf="searchModel.TravelForm?.Organization?.Code">({{searchModel.TravelForm?.Organization?.Code}})
        </ng-container>
      </ion-label>
      <!-- <div [(ngModel)]="searchModel.TravelForm.Organization.Name" slot="end">
          <label color="danger">
              请选择所属部门
          </label>
      </div> -->
    </ion-item>
    <ion-item>
      <ion-label>
        出差事由
      </ion-label>
      <ion-input placeholder="请输入" type="text"  slot="end" class="ion-text-end" [(ngModel)]="searchModel.TravelForm.Subject">
      </ion-input>
      
    </ion-item>
    <ion-item>
      <ion-label>客户或公司</ion-label>
      <ion-input placeholder="请输入" slot="end" class="ion-text-end" [(ngModel)]="searchModel.TravelForm.CustomerName">
      </ion-input>
    </ion-item>
    <ion-item>
      <ion-label>
        出差类别
      </ion-label>
      <ion-select slot="end" class="ion-text-end" [(ngModel)]="searchModel.TravelForm.TripType" okText="确定"
        cancelText="取消" [compareWith]="compareWithFn">
        <ion-select-option value="国内">国内</ion-select-option>
        <ion-select-option value="国际">国际</ion-select-option>
        <ion-select-option value="港澳台">港澳台</ion-select-option>
      </ion-select>
    </ion-item>
    <app-add-stroke *ngFor="let item of searchModel.TravelForm.Trips;let idx=index;" [index]="idx" [trip]='item'
      (remove)='onRemoveTrip($event)'></app-add-stroke>
    <ion-button color='secondary' class="ion-padding-horizontal" expand='block' fill='outline' (click)="onAddTrip()">
      <ion-icon name='add-circle-outline' color='secondary'></ion-icon>
      添加行程
    </ion-button>
    <ion-item>
      <ion-label>
        出差天数统计
      </ion-label>
      <label slot="end" class="ion-text-end" *ngIf="getAllTravelDays()">
        {{getAllTravelDays()+1}}
      </label>
    </ion-item>
    <ion-item>
      <ion-label>
        备注
      </ion-label>
      <ion-input placeholder="请输入" slot="end" class="ion-text-end" [(ngModel)]="searchModel.TravelForm.Detail">
      </ion-input>
    </ion-item>
    <ion-item detail (click)="onSelectCostCenter()">
      <ion-label>成本中心</ion-label>
      <ion-label class="ion-text-end" color="{{searchModel.TravelForm?.CostCenterName?'dark':'medium'}}">
        {{searchModel.TravelForm?.CostCenterName||" "}}</ion-label>
    </ion-item>
    <ion-item detail (click)='openApproverModal()' *ngIf="tmc?.TravelApprovalType=='Free'" [(ngModel)]="searchModel.AccountId">
      <ion-label>
        <ion-label>审批人</ion-label>
        <ion-label class="ion-text-end" color="medium">
          {{appovalStaff}}
        </ion-label>
      </ion-label>
    </ion-item>
    <ion-item>
      <ion-button slot='end' color="secondary" style="width: 7em;height: 2.4em;" (click)="onSave()">
        保存
      </ion-button>
      <ion-button slot='end' color="secondary" (click)="onSubmit()" style="width: 7em;height: 2.4em;">
        提交
      </ion-button>
    </ion-item>
  </ion-list>
</ion-content>