<div class='order-item' *ngIf='order'>
  <ion-row>
    <ion-col size='3'>
      订单编号
    </ion-col>
    <ion-col>
      <strong style="margin-right: 0.5em; user-select: text; ">{{order.Id}}</strong>
    </ion-col>
    <ion-col *ngIf='checkPay()'>
      <ion-buttons class='pay-btn'>
        <ion-button (click)='onPay($event)' size='small' color='secondary'
          style="font-size: .8rem;margin-left: auto;margin-right: 0em;">现在去支付
        </ion-button>
      </ion-buttons>
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col size='3'>
      完成时间
    </ion-col>
    <ion-col>
      <span *ngIf='order.InsertDateTime'>
        {{order.InsertDateTime}}
      </span>
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col size='3'>
      订单状态
    </ion-col>
    <ion-col>
      <ion-text color='secondary'>
        {{order.StatusName == "等待处理" ? "等待审批" : order.StatusName}}</ion-text>
    </ion-col>
  </ion-row>
  <ion-row *ngIf='order?.OrderPassengers?.length'>
    <ion-col style="align-self: flex-start;" size='3'>旅客信息</ion-col>
    <ion-col>
      <div class='passenger' *ngFor='let p of order.OrderPassengers'>
        <ion-row>
          <ion-col>
            <ion-text color='dark'>
              {{p.CheckName}}
            </ion-text>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-text color='dark'>
              {{p.CredentialsNumber}}
            </ion-text>
          </ion-col>
        </ion-row>
      </div>
    </ion-col>
  </ion-row>
  <ng-container *ngFor='let orderFlightTicket of order.OrderFlightTickets' class='order-flight-trip'>
    <ion-row>
      <ion-col size='3'>
        机票事务号
      </ion-col>
      <ion-col>
        <ion-text color='ticketIsReject(orderFlightTicket)?"danger":""' style='user-select: text;'>{{orderFlightTicket.Id}}</ion-text>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size='3'>行程信息</ion-col>
    </ion-row>
    <ng-container *ngFor='let orderFlightTrip of orderFlightTicket.OrderFlightTrips;'>
      <ion-row class='ticket-trip'>
        <ion-col>
          <ion-label color='dark'>
            <ng-container *ngIf='orderFlightTrip.Status == OrderFlightTripStatusType.Normal'>
              <div>
                <span>{{orderFlightTrip.TakeoffTime?.substr(0,"yyyy-mm-dd".length)}}</span>
                <span>{{getHHmm(orderFlightTrip.TakeoffTime)}}</span>
                <span
                  *ngIf='getDateWeekName(orderFlightTrip.TakeoffTime?.substr(0,"yyyy-mm-dd".length)) as n'>({{n}})</span>
                <span>{{orderFlightTrip.FlightNumber}}</span>
              </div>
              <div margin-start>
                起飞：{{orderFlightTrip.FromCityName}} <span *ngIf='orderFlightTrip.FromAirport as air'>({{air}})</span>
              </div>
              <div margin-start>
                到达：{{orderFlightTrip.ToCityName}} <span *ngIf='orderFlightTrip.ToAirport as air'>({{air}})</span>
              </div>
            </ng-container>
          </ion-label>
        </ion-col>
      </ion-row>
    </ng-container>
    <ion-row>
      <ion-col>
        <ion-text color='danger'>
          ￥{{getTotalAmount(order,orderFlightTicket.Key) + flightInsuranceAmount(orderFlightTicket)}}
          <span *ngIf='flightInsuranceAmount(orderFlightTicket) as insuranceAmount'>(含保险{{insuranceAmount}})</span>
        </ion-text>
      </ion-col>
      <ion-col size='3'>
        机票状态
      </ion-col>
      <ion-col>
        {{orderFlightTicket.StatusName}}
      </ion-col>
      <ion-col>
        <ion-button *ngIf='showRefundBtn(orderFlightTicket)' (click)='onRefundFlightTicket($event,orderFlightTicket)'
          color='danger'>
          <ion-text color='light'>退票</ion-text>
        </ion-button>
      </ion-col>
    </ion-row>
  </ng-container>
  <ng-container *ngIf='order.OrderTrainTickets?.length'>
    <ng-container *ngFor='let orderTrainTicket of order.OrderTrainTickets'>
      <ng-container *ngIf='orderTrainTicket.OrderTrainTrips'>
        <ion-row>
          <ion-col>
            <ion-text color='ticketIsReject(orderTrainTicket)?"danger":""' >火车票事务号</ion-text>
          </ion-col>
          <ion-col>
            <ion-text color='ticketIsReject(orderTrainTicket)?"danger":""' style='user-select: text;'>{{orderTrainTicket.Id}}</ion-text>
          </ion-col>
        </ion-row>
      </ng-container>
      <ion-row>
        <ion-col>
          <ion-label>
            <div *ngFor='let orderTrainTrip of orderTrainTicket.OrderTrainTrips'>
              <span>{{orderTrainTrip.StartTime?.substr(0,"yyyy-mm-dd".length)}}</span>
              <span>{{orderTrainTrip.FromStationName}}---{{orderTrainTrip.ToStationName}}</span>
              <span>{{orderTrainTrip.TrainNo}}</span>
              <span>{{getHHmm(orderTrainTrip.StartTime)}}</span>
            </div>
          </ion-label>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <ion-text color='danger'>
            ￥{{getTotalAmount(order,orderTrainTicket.Key) + trainInsuranceAmount(orderTrainTicket)}}
            <span *ngIf="trainInsuranceAmount(orderTrainTicket) as amount">(含保险{{amount}})</span>
          </ion-text>
        </ion-col>
        <ion-col>
          {{orderTrainTicket.StatusName}}
          <ion-button (click)='onExchange($event,orderTrainTicket)' color='secondary'
            *ngIf='false && orderTrainTicket.Status == OrderTrainTicketStatusType.Issued && tmc?.TrainIsAllowExchange && TrainSupplierType[orderTrainTicket.Supplier] !=0 && orderTrainTicket.BookType != TrainBookType.Offline'>
            <span>改签</span>
          </ion-button>
          <ion-button (click)='onRefundTrainTicket($event,orderTrainTicket)' color='secondary'
            *ngIf='(orderTrainTicket.Status == OrderTrainTicketStatusType.Issued || orderTrainTicket.Status == OrderTrainTicketStatusType.Exchanged) 
          &&  tmc?.TrainIsAllowRefund && TrainSupplierType[orderTrainTicket.Supplier] !="0" && orderTrainTicket.BookType != TrainBookType.Offline'>
            <span>退票</span>
          </ion-button>

        </ion-col>
      </ion-row>
    </ng-container>
  </ng-container>
  <ng-container *ngIf='order.OrderHotels?.length'>
    <ng-container *ngFor='let  orderHotel of order.OrderHotels'>
      <ion-row>
        <ion-col>
          酒店事务号
        </ion-col>
        <ion-col style='user-select: text;'>
          {{orderHotel.Id}}
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          酒店名称
        </ion-col>
        <ion-col>
          {{orderHotel.HotelName}}
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          入住
        </ion-col>
        <ion-col>
          {{orderHotel.BeginDate?.substr(0,"yyyy-MM-dd".length)}}
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          离店
        </ion-col>
        <ion-col>
          {{orderHotel.EndDate?.substr(0,"yyyy-MM-dd".length)}}
        </ion-col>
      </ion-row>
      <ion-row *ngIf='orderHotel.ConfirmNumber as cnumber'>
        <ion-col>
          酒店确认号
        </ion-col>
        <ion-col>
          {{cnumber}}
        </ion-col>
      </ion-row>
      <ion-row *ngIf='false'>
        <ion-col *ngIf='false'>
          <ion-text color='danger'>￥{{getTotalAmount(order,orderHotel.Key)}}</ion-text>
        </ion-col>
        <ion-col>
          {{orderHotel.StatusName}}
          <ion-button
            *ngIf='false&&orderHotel.Status == OrderHotelStatusType.PayFailure && orderHotel.PaymentType == HotelPaymentType.SelfPay'>
            重新担保</ion-button>
        </ion-col>
      </ion-row>
    </ng-container>
  </ng-container>
</div>