<ion-header>
  <ion-toolbar>
      <ion-buttons slot="start">
          <ion-back-button></ion-back-button>
        </ion-buttons>
    <ion-title>绑定</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content padding>
<form [formGroup]='form'>
  <section>
    <ion-row>
      <ion-col size="3">
        <ion-label position="floating">手机号</ion-label>
      </ion-col>
      <ion-col>
        <ion-input
          placeholder="手机号"
          formControlName="Mobile"
          type="number"
          min="11"
        ></ion-input>
      </ion-col>
      <ion-col size="4" *ngIf="!isDisableSendMobileCode; else countdown">
        <ion-button
          size="small"
          fill="outline"
          color="primary"
          [disabled]="!isMobileNumberOk"
          (click)="startCountDonw(60)"
        >
          <span [style.font-size.rem]="0.8">发送验证码</span>
        </ion-button>
      </ion-col>
      <ng-template #countdown>
        <ion-col class="down-count" size="1.5">
          <ion-label color="medium">{{ countDown }} s</ion-label>
        </ion-col>
      </ng-template>
    </ion-row>

    <ion-row *ngIf="phoneErrorCount >= validImageCodeCount">
      <ion-col>
        <ion-label position="floating">验证码</ion-label>
      </ion-col>
      <ion-col>
        <ion-input
          type="text"
          text-uppercase
          formControlName="ImageCode"
          placeholder="右边图片内容"
        ></ion-input>
      </ion-col>
      <ion-col *ngIf="(imgSrc$ | async) as url" class="image-code" text-center>
        <img [src]="url" alt="{{ url }}" (click)="refreshImageCode()" />
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="4">
        <ion-label position="floating">短信验证码</ion-label>
      </ion-col>
      <ion-col>
        <ion-input
          placeholder="请输入收到短信验证码"
          formControlName="MobileCode"
        ></ion-input>
      </ion-col>
    </ion-row>
    <ion-row text-center>
      <ion-col>
        <ion-button fill='clear' [routerLink]='["../"]' color='primary' text-end>跳过</ion-button>
      </ion-col>
    </ion-row>
  </section>
</form>
</ion-content>
